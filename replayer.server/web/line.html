<html>
<head>
    <link href="libs/bootstrap.min.css" rel="stylesheet"/>
    <script src="libs/jquery-3.2.1.min.js"></script>
    <script src="libs/bootstrap.min.js"></script>
    <link href="app/app.css" rel="stylesheet"/>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-md-8">
            <br>
            <button type="button"  class="btn btn-default" onClick="location.href='index.html'">Back to Scripts</button>
            <button type="button"  class="btn btn-default" id="backToSingle"  name="backToSingle" >???</button>
        </div>
        <div class="col-md-8">
            <h3>LINE</h3>
        </div>

        <div class="col-md-8">
            <div class="form-group">
                <label htmlFor="id">Id</label>
                <input class="form-control" readOnly type="text" name="id" id="id"/>
            </div>
            <div class="form-group">
                <label htmlFor="timestamp">Timestamp</label>
                <input class="form-control" readOnly type="text" name="timestamp" id="timestamp"/>
            </div>
        </div><div class="col-md-8">
        <h3>REQUEST</h3>
    </div>
        <div class="col-md-8">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="request_static" name="request_static">
                <label class="form-check-label" for="request_static">
                    Is Static
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="request_soap" name="request_soap">
                <label class="form-check-label" for="request_soap">
                    Is Soap
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="request_binary" name="request_binary">
                <label class="form-check-label" for="request_binary">
                    Is Binary
                </label>
            </div>
            <div class="form-group">
                <label htmlFor="request_method">Method</label>
                <input class="form-control" type="text" name="request_method" id="request_method"/>
            </div>
            <div class="form-group">
                <label htmlFor="request_protocol">Protocol</label>
                <input class="form-control" type="text" name="request_protocol" id="request_protocol"/>
            </div>
            <div class="form-group">
                <label htmlFor="request_port">Port</label>
                <input class="form-control" type="text" name="request_port" id="request_port"/>
            </div>
            <div class="form-group">
                <label htmlFor="request_host">Host</label>
                <input class="form-control" type="text" name="request_host" id="request_host"/>
            </div>
            <div class="form-group">
                <label htmlFor="request_path">Path</label>
                <input class="form-control" type="text" name="request_path" id="request_path"/>
            </div>
        </div>

        <div class="col-md-8">
            <h4>REQUEST QUERY</h4>
        </div>
        <div class="col-md-8">
            <table class="table table-striped" id="request_queryTable">
                <tr>
                    <th>Key</th>
                    <th>Value</th>
                </tr>
            </table>
        </div>
        <div class="col-md-8">
            <h4>REQUEST POST PARAMETERS</h4>
        </div>
        <div class="col-md-8">
            <table class="table table-striped" id="request_postTable">
                <tr>
                    <th>Key</th>
                    <th>Value</th>
                </tr>
            </table>
        </div>
        <div class="col-md-8">
            <h4>REQUEST HEADERS</h4>
        </div>
        <div class="col-md-8">
            <table class="table table-striped" id="request_headerTable">
                <tr>
                    <th>Key</th>
                    <th>Value</th>
                </tr>
            </table>
        </div>

        <div class="col-md-8">
            <h3>RESPONSE</h3>
        </div>

        <div class="col-md-8">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="response_binary" name="response_binary">
                <label class="form-check-label" for="response_binary">
                    Is Binary
                </label>
            </div>
            <div class="form-group">
                <label htmlFor="response_code">Status Code</label>
                <input class="form-control" type="text" name="response_code" id="response_code"/>
            </div>
        </div>
        <div class="col-md-8">
            <h4>RESPONSE HEADERS</h4>
        </div>
        <div class="col-md-8">
            <table class="table table-striped" id="response_headerTable">
                <tr>
                    <th>Key</th>
                    <th>Value</th>
                </tr>
            </table>
        </div>
    </div>
</div>
<!-- Modal -->
<div aria-labelledby="myModalLabel" class="modal fade" id="myModal" role="dialog" tabindex="-1">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button aria-label="Close" class="close" data-dismiss="modal" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Update User</h4>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer"></div>
        </div>
    </div>
</div>
<script src="app/app.js"></script>
<script>
    var request_headerTable = new SimpleGrid("Request-Headers","request_headerTable","key",["key","value"],
        null,
        function (table,id) {
            editKvp(table,id,"key","value")
        },
        function (table,id) {
            deleteKvp(table,id,"key","value")
        },
        function (table,id) {
            updateKvp(table,id,"key","value")
        });
    var request_queryTable = new SimpleGrid("Query","request_queryTable","key",["key","value"],
        null,
        function (table,id) {
            editKvp(table,id,"key","value")
        },
        function (table,id) {
            deleteKvp(table,id,"key","value")
        },
        function (table,id) {
            updateKvp(table,id,"key","value")
        });
    var request_postTable = new SimpleGrid("PostParameters","request_postTable","key",["key","value"],
        null,
        function (table,id) {
            editKvp(table,id,"key","value")
        },
        function (table,id) {
            deleteKvp(table,id,"key","value")
        },
        function (table,id) {
            updateKvp(table,id,"key","value")
        });
    var response_headerTable = new SimpleGrid("Response-Headers","response_headerTable","key",["key","value"],
        null,
        function (table,id) {
            editKvp(table,id,"key","value")
        },
        function (table,id) {
            deleteKvp(table,id,"key","value")
        },
        function (table,id) {
            updateKvp(table,id,"key","value")
        });

    $.ajax({
        url: "/api/recording/" + getUrlParameter("id")+"/line/"+getUrlParameter("line"),
        type: 'GET',
        success: function (res) {
            $("#timestamp").val(res['timestamp']);
            $("#id").val(res['id']);

            //Request
            $("#request_method").val(res['request']['method']);
            $("#request_protocol").val(res['request']['protocol']);
            $("#request_host").val(res['request']['host']);
            $("#request_path").val(res['request']['path']);
            $("#request_port").val(res['request']['port']);
            setChecked($("#request_checked"),res['request']['staticRequest']);
            setChecked($("#request_soap"),res['request']['soapRequest']);
            setChecked($("#request_binary"),res['request']['binaryRequest']);
            $.each(res["request"]["headers"], function (i, v) {
                var line = {key:i,value:v};
                request_headerTable.appendToTable( line);
            });
            $.each(res["request"]["query"], function (i, v) {
                var line = {key:i,value:v};
                request_queryTable.appendToTable(line);
            });
            $.each(res["request"]["postParameters"], function (i, v) {
                var line = {key:i,value:v};
                request_postTable.appendToTable(line);
            });

            //Response
            $("#response_code").val(res['response']['statusCode']);
            setChecked($("#response_binary"),res['response']['binaryResponse']);
            $.each(res["response"]["headers"], function (i, v) {
                var line = {key:i,value:v};
                response_headerTable.appendToTable(line);
            });
        }
    });

    $("#backToSingle").click(function(){ location.href="script.html?id="+getUrlParameter("id"); }).html("Return to "+getUrlParameter("id")+" Script");


</script>
</body>
</html>